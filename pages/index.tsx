import axios from 'axios';
import type { NextPage } from 'next';
import Head from 'next/head';
import Image from 'next/image';
import styles from '../styles/Home.module.scss';
import BasicTabs from '../components/Header';
import Footer from '../components/Footer';
import { Button, Container, Stack } from '@mui/material';
import {
  Chart as ChartJS,
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  Title,
  Tooltip,
  Legend,
} from 'chart.js';
import { Line } from 'react-chartjs-2';
import WordCloud from 'react-d3-cloud';

import faker from 'faker';
import { useState } from 'react';

ChartJS.register(
  CategoryScale,
  LinearScale,
  PointElement,
  LineElement,
  Title,
  Tooltip,
  Legend
);

const Home: NextPage = () => {
  const instance = axios.create({
    baseURL: 'https://3.18.104.128:5000',
  });

  const options = {
    responsive: true,
    plugins: {
      legend: {
        position: 'top' as const,
      },
      title: {
        display: true,
        text: 'Chart.js Line Chart',
      },
    },
  };
  const cloudData = [
    { text: '비트코인', value: 14000 },
    { text: 'bit-coin', value: 11200 },
    { text: '이더리움', value: 11800 },
    { text: '알트', value: 1110 },
    { text: '리플', value: 1140 },
    { text: '도지', value: 11080 },
    { text: '코인1', value: 1100 },
    { text: '코인2', value: 2910 },
    { text: '코인3', value: 4510 },
    { text: '코인5', value: 2210 },
    { text: '코인7', value: 4510 },
    { text: '코인8', value: 1910 },
    { text: '코인9', value: 210 },
    { text: '코인10', value: 310 },
    { text: '코인1', value: 1100 },
    { text: '코인2', value: 2910 },
    { text: '코인3', value: 4510 },
    { text: '코인4', value: 1910 },
    { text: '코인5', value: 2210 },
    { text: '코인6', value: 3100 },
    { text: '코인7', value: 4510 },
    { text: '코인8', value: 1910 },
    { text: '코인10', value: 3010 },
    { text: '코인1', value: 11000 },
    { text: '코인2', value: 2910 },
    { text: '코인3', value: 4510 },
    { text: '코인4', value: 1910 },
    { text: '코인5', value: 2010 },
    { text: '코인6', value: 3010 },
  ];
  const cloudData2 = [
    { text: '애플', value: 14000 },
    { text: 'ETF', value: 11200 },
    { text: 'qqq', value: 11800 },
    { text: 'fqqq', value: 1110 },
    { text: '테슬라', value: 1140 },
    { text: '우주주', value: 11080 },
    { text: '나스닥', value: 1100 },
    { text: 'S&P500', value: 2910 },
    { text: '구글', value: 4510 },
    { text: 'google', value: 2210 },
    { text: 'MS', value: 4510 },
    { text: '마이크로소프트', value: 1910 },
    { text: 'FTQE', value: 210 },
    { text: 'FTQEW', value: 310 },
    { text: 'FTQE3', value: 1100 },
    { text: 'FTQEE', value: 2910 },
    { text: 'FTQE4', value: 4510 },
    { text: 'FTQE', value: 1910 },
    { text: 'FTQE4', value: 2210 },
    { text: 'FTQE', value: 3100 },
    { text: 'FTQE5', value: 4510 },
    { text: 'FTQE6', value: 1910 },
    { text: 'FTQE', value: 3010 },
    { text: 'FTQE7', value: 11000 },
    { text: 'FTQE88', value: 2910 },
    { text: 'FTQE7', value: 4510 },
    { text: 'FTQE6', value: 1910 },
    { text: 'FTQE4', value: 2010 },
    { text: 'FTQE', value: 3010 },
  ];
  const labels = [
    'January',
    'February',
    'March',
    'April',
    'May',
    'June',
    'July',
  ];

  const data = {
    labels,
    datasets: [
      {
        label: 'Dataset 1',
        data: labels.map(() =>
          faker.datatype.number({ min: -1000, max: 1000 })
        ),
        borderColor: 'rgb(255, 99, 132)',
        backgroundColor: 'rgba(255, 99, 132, 0.5)',
      },
      {
        label: 'Dataset 2',
        data: labels.map(() =>
          faker.datatype.number({ min: -1000, max: 1000 })
        ),
        borderColor: 'rgb(53, 162, 235)',
        backgroundColor: 'rgba(53, 162, 235, 0.5)',
      },
    ],
  };

  const data2 = {
    labels,
    datasets: [
      {
        label: 'Dataset 1',
        data: labels.map(() =>
          faker.datatype.number({ min: -1000, max: 1000 })
        ),
        borderColor: 'rgb(255, 99, 132)',
        backgroundColor: 'rgba(255, 99, 132, 0.5)',
      },
      {
        label: 'Dataset 2',
        data: labels.map(() =>
          faker.datatype.number({ min: -1000, max: 1000 })
        ),
        borderColor: 'rgb(53, 162, 235)',
        backgroundColor: 'rgba(53, 162, 235, 0.5)',
      },
    ],
  };

  const [tab, setTab] = useState(0);
  return (
    <Container fixed>
      <Head>
        <title>퓨처비트</title>
        <meta name='description' content='Generated by create next app' />
        <link rel='icon' href='/favicon.ico' />
        <link
          rel='stylesheet'
          href='https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap'
        />
      </Head>
      <BasicTabs />
      <Stack spacing={2}>
        <div>
          <button
            className={`${styles.tab} ${tab === 0 ? styles.on : ''}`}
            onClick={() => {
              setTab(0);
            }}
          >
            암호화폐 키워드
          </button>
          <button
            className={`${styles.tab} ${tab === 1 ? styles.on : ''}`}
            onClick={() => {
              setTab(1);
            }}
          >
            해외주식 키워드
          </button>
        </div>
        {tab === 0 ? (
          <section className={styles.wordCloud}>
            암호화폐 키워드
            {typeof window === 'object' ? (
              <WordCloud
                width={1000}
                height={750}
                data={cloudData}
                padding={2}
              />
            ) : (
              ''
            )}
          </section>
        ) : tab === 1 ? (
          <section className={styles.wordCloud}>
            해외주식 키워드
            {typeof window === 'object' ? (
              <WordCloud
                width={1000}
                height={750}
                data={cloudData2}
                padding={2}
              />
            ) : (
              ''
            )}
          </section>
        ) : (
          ''
        )}
        <section className={styles.bitCoinCart}>
          비트코인
          <Line options={options} data={data} />
        </section>
        <section className={styles.bitCoinCart}>
          텍스트 감성 분석 차트
          <Line options={options} data={data2} />
        </section>
        <section
          style={{ height: '400px', width: '100%', border: 'solid 1px #000' }}
        >
          뉴스
        </section>
        <Button
          onClick={async () => {
            try {
              const data = await instance.get('/bitgal/retrieval');
              console.log(data);
            } catch (err) {
              console.log('err:', err);
            }
          }}
        >
          getApis
        </Button>
      </Stack>
      <Footer />
    </Container>
  );
};

export default Home;
